<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>GE Foundry Predix Training</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/black.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
</head>

<style>
    em {
        color: darkgrey;
    }

    code {
        color: darkgrey;
    }
</style>

<body>

<div class="reveal">

    <div class="slides">

        <section data-markdown="slides/index.md"></section>

        <section>
            <h3>Startup and Ingestion Lvl 1</h3>
            <ul>
                <li><b style="color:grey">&nbsp;&nbsp;8:45 – 10:45</b> Architectural Overview & Predix Tooling</li>
                <li><b style="color:grey">10:45 – 11:00</b> Break</li>
                <li><b style="color:grey">11:00 – 12:45</b> Machine Setup (Dev environment)</li>
                <li><b style="color:grey">12:45 – 13:45</b> Lunch Break</li>
                <li><b style="color:grey">13:45 – 14:45</b> Security Model & UAA</li>
                <li><b style="color:grey">14:45 – 15:00</b> Break</li>
                <li><b style="color:grey">15:00 – 17:00</b> Time Series</li>
                <li><b style="color:grey">17:00 – 17:30</b> Q&A</li>
            </ul>
        </section>

        <section>
            <section>
                <em>"The cloud is not about where computing is done, it’s about how computing is done.”</em>
                <br/>
                <br/>
                <p align="right">
                    Paul Maritz!<br/>
                    Executive Chairman, Pivotal!
                </p>
            </section>

            <section>
                <h4>Predix Architecture Overview</h4>
                <img src="./images/home_diagrame_2x.png"
                     style="background-color:white;width:1175px;height:404px;">
            </section>

            <section>
                <h4>Why such choice !</h4>
                <img src="./images/slide-1.png"
                     style="background-color:white;width:1600px;height:100%;">
            </section>

            <section>
                <h3 align="left">Cloud Foundry is a bit ironic</h3>
                <h6 align="left">it is <em> opinionated</em></h6>
                It allows you to organize, simplify and lock down your IT infrastructure
                <br/>
                <br/>
                <h6 align="left">It is <em>open and flexible</em></h6>
                <ul>
                    <li> It works on multiple infrastructures (Amazon Web Services,
                        vSphere, OpenStack...)
                    </li>
                    <li> It works in conjunction with your existing applications, tools and services</li>
                    <li> It works with many languages and frameworks</li>
                </ul>
            </section>

            <section>
                <h4>CEO Perspective- Focus on the Business Domain</h4> <br/>
                <p align="left">What is Cloud Foundry from a CEO’s perspective? </p>
                <br/>
                <p align="left">Google, Facebook, Twitter, Netflix, etc. have thousands of engineers working on
                    their
                    unique, consumer-grade platforms</p>
                <br/>
                <p align="left">Cloud Foundry encapsulates industry best practices in a platform, allowing
                    enterprises
                    to
                    <b>focus on their business domain</b></p>
            </section>

            <section>
                <h4>CEO Perspective- Transformational </h4> <br/>
                <p align="left">Cloud Foundry is transformational in two ways:</p> <br/>
                <ol>
                    <li>Business- it facilitates the change to agile, cloud-native software development processes
                    </li>
                    <br/>
                    <li>Technology- enables a simplified, efficient, scalable infrastructure</li>
                </ol>
            </section>

            <section>
                <h6>Predix Cloud Foundry Commercialization Model</h6>
                <div>
                    <div style="float: left;width:25%;font-size: xx-large;" align="left"><br/>Open source software
                        provides
                        the basis for the platform <br/><br/><br/>
                        Commercial distribution provides value add features, enterprise services, support, docs,
                        certs,
                        etc.
                    </div>
                    <div style="float: right;width:70%;">
                        <img src="./images/predix-cf.png" style="background-color:white;width:120%;height:120%;">
                    </div>
                </div>
            </section>

            <section>
                <h6>Predix CF Components - 1.4</h6>
                <img src="./images/cf-nodiego.png">
            </section>

            <section>
                <h6>Predix CF Components - Diego</h6>
                <img src="./images/cf-diego.png">
            </section>

            <section>
                <h6>Load Balancer (HA Proxy)</h6>
                <div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul>
                            <li>HAProxy is separate component from the Router</li>
                            <ul>
                                <li>Sits in front of the router</li>
                                <li>By default only one instance defined</li>
                            </ul>
                            <li>Cloud Foundry can only have one IP address visible to outside world</li>
                            <ul>
                                <li>This is the Load Balancer</li>
                                <li>It passes requests to the Router(s) to send to the right CF component</li>
                            </ul>
                        </ul>
                    </div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Responsibilities:</p>
                        <ul>
                            <li>Load-balancing across multiple routers (if used)</li>
                            <li>SSL Termination</li>
                            <br/>
                            <li><b>Note:</b> Typically need to configure your own HAProxy (in an HA configuration)
                                or
                                other
                                load- balancer (such as F5 or NSX) for improved performance/SSL handling
                            </li>
                        </ul>
                    </div>
                </div>
            </section>
            <section>
                <h6>(Go) Router</h6>
                <div>
                    <div style="float: left;width:50%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul>
                            <li>Routes all incoming HTTP traffic</li>
                            <ul>
                                <li>System traffic (cf commands)</li>
                                <li>Application traffic</li>
                            </ul>
                            <li>Maintains dynamic routing table
                                for each load-balanced app
                                instance
                            </li>
                            <ul>
                                <li>Knows IP addresses and ports.</li>
                            </ul>
                            <li>Multiple routers possible</li>
                            <ul>
                                <li>Configured by admin in Ops Manager</li>
                                <li>Rewritten in Go since CF 1.4 – the GoRouter</li>
                            </ul>
                        </ul>
                    </div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Responsibilities:</p>
                        <ul>
                            <li>Load balancing across application instances</li>
                            <li>Maintaining an active routing table</li>
                            <li>Access logs</li>
                            <li>Supports web-sockets</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6>UAA and Login Services</h6>
                <div>
                    <div style="float: left;width:50%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul style="font-size: x-large;">
                            <li>UAA = “User Account and Authentication”</li>
                            <li>Provides identity, security and
                                authorization services.
                            </li>
                            <li>Manages third party OAuth 2.0 access credentials</li>
                            <li>Can provide application access & identity-as-a-service for CF apps</li>
                            <li>Composed of</li>
                            <ul>
                                <li>UAA Server</li>
                                <li>Command Line Interface (UAAC)</li>
                                <li>Library.</li>
                            </ul>
                            <li>Multiple UAA/Login Servers possible</li>
                        </ul>
                    </div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Responsibilities:</p>
                        <ul style="font-size: x-large;">
                            <li>Token Server</li>
                            <li>ID Server (User management)</li>
                            <li>OAuth Scopes (Groups) and SCIM (System for Cross-domain Identity Management)</li>
                            <li>Login Server</li>
                            <ul>
                                <li>UAA Database</li>
                                <li>SAML support (for SSO
                                    integration) and Active Directory support with the VMWare SSO Appliance
                                </li>
                            </ul>
                            <li>Access auditing</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6>Cloud Controller (CC)</h6>
                <div>
                    <div style="float: left;width:50%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul style="font-size: x-large;">
                            <li>Command and Control
                                <ul>
                                    <li>Responds to clients (CLI, App Manager, IDEs)</li>
                                    <li>Account and provisioning control.</li>
                                </ul>
                            </li>
                            <li>Provides RESTful interface to domain objects
                                <ul>
                                    <li>Apps, services, organizations, spaces, service instances, user roles, and
                                        more
                                        ...
                                    </li>
                                </ul>
                            </li>
                            <li>Multiple Cloud Controllers possible
                                <ul>
                                    <li>Configurable by Admin</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Responsibilities:</p>
                        <ul style="font-size: x-large;">
                            <li>Expected Application state</li>
                            <li>State transitions</li>
                            <li>Permissions/Authorization</li>
                            <li>Organizations/Spaces/Users</li>
                            <li>Services management</li>
                            <li>Auditing/Journaling and billing events</li>
                            <li>Blob Storage</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6>Cloud Controller Database (CCDB)</h6>
                <div>
                    <div style="float: left;width:50%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul>
                            <li>Storage for application metadata</li>
                            <li>Used exclusively by the Cloud Controller</li>
                        </ul>
                    </div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Responsibilities:</p>
                        <ul>
                            <li>Stores information like</li>
                            <ul>
                                <li>Application Name</li>
                                <li># of instances requested</li>
                                <li>Memory Limits</li>
                                <li>Routes</li>
                                <li>Bound Services</li>
                            </ul>
                            <li>A Postgres DB instance</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6>BlobStore</h6>
                <div>
                    <div style="float: left;width:50%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul>
                            <li>Storage for binary large objects</li>
                            <li>Eliminates need for upload / re- staging when scaling applications</li>
                            <li>Currently NFS mounted storage
                                <ul>
                                    <li>Or Amazon S3 store</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Responsibilities:</p>
                        <ul>
                            <li>Stores uploaded application packages (cf push)</li>
                            <li>Stores Droplets
                                <ul>
                                    <li>As a compressed tar file</li>
                                    <li>Or Docker containers</li>
                                    <li>Or (coming) Windows .NET applications</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6> CC Bridge - Diego</h6>
                <div>
                    <div style="float: left;width:50%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul style="font-size: x-large;">
                            <li>Translate app-specific requests into the generic language of LRP and Task
                                <ul>
                                    <li>For example requests to stage,
                                        start, stop, scale applications
                                    </li>
                                </ul>
                            </li>
                            <li>Allows existing CF components to interact with Diego</li>
                        </ul>
                    </div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Responsibilities:</p>
                        <ul style="font-size: x-large;">
                            <li>Places requests (actions) onto the Bulletin Board to be actioned by a Cell's
                                “Executor”
                            </li>
                            <li>Ensures that these actions take place (eventually)</li>
                            <li>Tracks running processes
                                <ul>
                                    <li>Provides info on running tasks and LRPs (Long Running Processes) to Cloud
                                        Controller
                                    </li>
                                    <li>Accepts desired state of tasks and LRPs from Cloud Controller</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6>Droplet Execution Agents / Cells</h6>
                <div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul style="font-size: x-large;">
                            <li>Droplet Execution Agents (DEA's), renamed “Cells” in Diego</li>
                            <li>Secure and fully isolated containers
                                <ul>
                                    <li>A Virtual Machine (VM)</li>
                                </ul>
                            </li>
                            <li>Periodically broadcast messages about their state</li>
                            <li>Typically many DEA's/cells in a Cloud Foundry installation</li>
                        </ul>
                    </div>
                    <br/>
                    <div style="float: left;width:45%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Responsibilities:</p>
                        <ul style="font-size: x-large;">
                            <li>Managing app containers</li>
                            <li>Monitoring resource pools
                                <ul>
                                    <li>Process, file system, network, memory</li>
                                </ul>
                            </li>
                            <li>Managing app lifecycle - starting and stopping apps as instructed</li>
                            <li>App log and file streaming</li>
                            <li>Sending heartbeats for health monitoring</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6>Cell Internal Components</h6>
                <div style="float: left;width:50%;font-size: xx-large;" align="left">
                    <ul>
                        <li><p style="color:dodgerblue;">Rep</p>
                            <ul>
                                <li>Represents Cell</li>
                                <li>Mediates BBS comms</li>
                                <li>Bids on tasks</li>
                                <li>Schedules them on the Executor</li>
                            </ul>
                        </li>
                        <li><p style="color:dodgerblue;">Receptor</p>
                            <ul>
                                <li>Respond to request for tasks ans desired LRPs</li>
                                <li>Fetch information about currently running tasks and LRP instances</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div style="float: right;width:50%;font-size: xx-large;" align="left">
                    <ul>
                        <li><p style="color:dodgerblue;">Executor</p>
                            <ul>
                                <li>Responsible for executing work (actions) given to it</li>
                                <li>Spins up a Garden container and executes the work encoded in Task/LRP</li>
                            </ul>
                        </li>
                        <li><p style="color:dodgerblue;">Metron Agent</p>
                            <ul>
                                <li>Monitors all containers on Cell</li>
                                <li>Provides logging and metrics to Loggregator for all apps/tasks running on Cell
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Warden / Garden</h6>
                <div>
                    <div style="float: left;width:45%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul>
                            <li>Isolated Process
                                <ul>
                                    <li>Safe, lightweight alternative to full VM</li>
                                </ul>
                            </li>
                            <li>Allows multiple applications to run
                                on each VM
                            </li>
                            <li>Garden is Warden rewritten in Go</li>
                        </ul>
                    </div>
                    <div style="float: left;width: 55%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Responsibilities:</p>
                        <ul>
                            <li>Isolates applications running on the same VM
                                <ul>
                                    <li>Individual failures does not affect other applications on the VM</li>
                                    <li>Uses kernel namespaces to isolate network, disk, memory and CPU</li>
                                    <li>Uses Linux cgroups to do resource management</li>
                                </ul>
                            </li>
                            <li>Secures applications from environment</li>
                            <li>Runs Droplets</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6>Garden - Implementations</h6>
                <div>
                    <div style="float: left;width:50%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul>
                            <li>Default implementation is Linux
                                <ul>
                                    <li>Pivotal's secure implementation
                                        of a Linux Container
                                    </li>
                                    <li>Similar to LXC using much
                                        lighter implementation
                                    </li>
                                </ul>
                            </li>
                            <li>But other implementations are
                                possible
                                <ul>
                                    <li>Such as Docker or Windows (coming)</li>
                                </ul>
                            </li>
                            <li>Garden is Warden rewritten in Go</li>
                        </ul>
                    </div>
                    <div style="float: left;width: 50%;font-size: xx-large;" align="right">
                        <p align="left" style="color:cornflowerblue;">Implementations:</p>
                        <ul>
                            <li><b>Default</b> Implementation
                                <ul>
                                    <li>Runs on a Linux VM (Cell)</li>
                                    <li>Uses kernel namespaces</li>
                                    <li>Uses Linux cgroups</li>
                                </ul>
                            </li>
                            <li>Docker implementation
                                <ul>
                                    <li>Runs on a Linux VM (Cell)</li>
                                    <li>Boots and runs a Docker
                                        application
                                    </li>
                                </ul>
                            </li>
                            <li>Windows implementation
                                <ul>
                                    <li>Runs on a Windows VM (Cell)</li>
                                    <li>Runs .NET applications</li>
                                    <li>Not yet available</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6>Cloud Foundry BOSH</h6>
                <div>
                    <div style="float: left;width:50%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Description:</p>
                        <ul>
                            <li>Tool chain for managing large scale distributed systems
                                <ul>
                                    <li>Release engineering</li>
                                    <li>Deployment and lifecycle
                                        management
                                    </li>
                                </ul>
                            </li>
                            <li>Continuous and predictive updates with minimal downtime</li>
                            <li>Control primitives (CPI) written for
                                each underlying infrastructure
                                provider
                                <ul>
                                    <li>Abstraction layer for the underlying IaaS</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div style="float: left;width:50%;font-size: xx-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Responsible For:</p>
                        <ul>
                            <li>IaaS installer
                                <ul>
                                    <li>vSphere, vCloud Air, AWS, Openstack, Azure(soon)</li>
                                </ul>
                            </li>
                            <li>VM creation and management</li>
                            <li>Continuous and predictive updates with minimal downtime</li>
                            <li>High Availability
                                <ul>
                                    <li>Restarts failed CF internal processes, DEA's</li>
                                </ul>
                            </li>
                            <li>CPI (Cloud Provider Interface) to control underling infrastructure (IaaS) primitives
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h6>Where do I work - <span style="color:cadetblue;">Organizations & Spaces</span></h6>
                <div style="float:top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Top-most administrative unit</li>
                        <li>Any Cloud Foundry installation can have multiple organizations defined in any way
                            <ul>
                                <li>
                                    Typically a company, department, application suite or large project
                                </li>
                            </ul>
                        </li>
                        <li>Designed to support many users working collaboratively</li>
                    </ul>
                </div>
                <br/>
                <div style="float:bottom;width:100%;font-size: x-large;" align="left">
                    <ul style="font-style:oblique;">
                        <li>Organizations contains multiple spaces</li>
                        <li>Spaces also can be defined in any way</li>
                        <li>For example, staging and production</li>
                    </ul>
                </div>
                <br/>
                <div style="float:bottom;width:100%;font-size: x-large;" align="left">
                    <ul>
                        <li>Applications and services are scoped to a space</li>
                        <li>Provides a set of users access for:
                            <ul>
                                <li>Application development</li>
                                <li>Functionality and/or performance testing – Quality assurance</li>
                                <li>Deployment to production</li>
                                <li>Maintenance</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>
        </section>

        <section>
            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">Virtual Box Install</span></h6>
                <div>
                    <div style="float: left;width:50%;font-size: x-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">Windows Machine:</p>
                        <ul>
                            <li>If you have a GE laptop the antivirus will block you, you need to install an old version
                                of
                                virtual box:
                                <a href="http://download.virtualbox.org/virtualbox/4.3.12/VirtualBox-4.3.12-93733-Win.exe">Virtual
                                    Box</a></li>
                            <br/>
                            <li>Otherwise you could use the latest and greatest <a
                                    href="http://download.virtualbox.org/virtualbox/5.1.10/VirtualBox-5.1.10-112026-Win.exe">Virtual
                                Box</a></li>
                        </ul>
                    </div>
                    <div style="float: right;width:48%;font-size: x-large;" align="left">
                        <p align="left" style="color:cornflowerblue;">OSX</p>
                        For OSX the easiest way to install virtual box is to use <a href="http://brew.sh/index_fr.html">brew</a><br>
                        <code>
                            brew cask install virtualbox \ virtualbox-extension-pack
                        </code>
                    </div>
                </div>
            </section>
            <section>
                <div>
                    <h6>Predix Dev Tools - <span style="color:cadetblue;">DevBox Install</span></h6>

                    <div style="float: left;width:50%;font-size: x-large;" align="left">
                        <ul style="float:left;font-size: x-large;">
                            <li>
                                For GE Employee go to <a
                                    href="https://devcloud.swcoe.ge.com/devspace/display/SOLSVC/Predix+DevBox+Program">Predix
                                DevBox Program</a>
                                <ul>
                                    <li><a href="https://goo.gl/PaHpfc">DevBox3.5.2-i.ova</a></li>
                                    <li><a href="https://goo.gl/lVyIME">sha</a></li>
                                    <li><a href="https://goo.gl/HFFxSV">md5</a></li>
                                </ul>
                            </li>
                            <br>
                            <li>For non Ge Employee go to
                                <ul>
                                    <li><a href="https://goo.gl/IxulwE">DevBox3.5.2-i.ova</a></li>
                                    <li><a href="https://goo.gl/DUu1IJ">sha</a></li>
                                    <li><a href="https://goo.gl/0LG2r6">md5</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div style="float: right;width:48%;font-size: x-large;" align="left">
                        <ul>
                            <li>Import the Ova into Virtual Box</li>
                        </ul>
                        The output should look like this :
                        <img src="./images/virtualbox.png"/>
                        The login/password is predix/predix
                    </div>
                </div>
            </section>
            <section>
                <div>
                    <h6>Predix Dev Tools - <span style="color:cadetblue;">DevBox Network Setup</span> - <span
                            style="color:crimson;font-size: large;">GE Employee only</span></h6>
                    <div style="float: left;width:50%;font-size: x-large;" align="left">
                        <ol>
                            <li>Login to the virtual machine</li>
                            <li>Open chrome browser go to settings and in proxy the automatic mode with : <em>http://myapps.setpac.ge.com/pac.pac</em>
                            </li>
                            <li>Check that you can have acces to https://predix.io</li>
                        </ol>
                    </div>
                    <div style="float: right;width:48%;font-size: x-large;" align="left">

                    </div>
                </div>
            </section>
            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">DevBox Network Setup</span> - <span
                        style="color:crimson;font-size: large;">Non GE Employee</span></h6>
                <div style="float: left;width:100%;font-size: x-large;" align="left">
                    <ul>
                        <li>If you are on a non proxied network you need to remove the proxy from the terminal
                            <ul>
                                <li> Open a terminal and type :
                                    <code>
                                        sudo gedit /etc/bashrc
                                    </code>
                                </li>
                                <li> Go to the botton of the file and comments <br/>
                                    <code>
                                        export http_proxy=http://sjc1intproxy01.crd.ge.com:8080/<br/>
                                        export https_proxy=$http_proxy <br/>
                                        export HTTP_PROXY=$http_proxy <br/>
                                        export HTTPS_PROXY=$http_proxy <br/>
                                        export no_proxy="127.0.0.1,localhost,localhost.localdomain,*.ge.com"
                                    </code>
                                </li>
                            </ul>
                        </li>
                        <li>Logout of the VM and Login again</li>
                        <li>Open a terminal and check that the following command result is empty</li>
                        <code> env | grep http_proxy</code>
                        <li>Try to download google index</li>
                        <code>wget https://www.google.com</code>
                        <li>Check that you have something</li>
                        <code>cat index.html</code>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">DevBox Maven Setup</span> - <span
                        style="color:crimson;font-size: large;">GE & Non Employee</span></h6>
                <div style="float: left;width:100%;font-size: x-large;" align="left">
                    <ul>
                        <li>On the devbox open <em>~/.m2/settings.xml</em></li>
                        <li>Search for this : <br/>
                            <code>
                                &lt;server&gt;<br/> &lt;id&gt;artifactory.external&lt;/id&gt;<br/> &lt;username&gt;your.predix.io.username&lt;/username&gt;<br/>
                                &lt;password&gt;your.encrypted.password&lt;/password&gt;<br/> &lt;!-- Obtained from
                                https://artifactory.predix.io --&gt;<br/>&lt;/server&gt;
                            </code>
                        </li>
                        <li>Replace username by your predix.io login (email address)</li>
                        <li>For the password get it from artifactory
                            <ul>
                                <li>Go to : <a href="https://artifactory.predix.io">https://artifactory.predix.io</a>
                                </li>
                                <li>Login using you predix.io login and password</li>
                                <li>Click on your name (up right)</li>
                                <li>enter your predix.io password</li>
                                <li>Click on the eye icon om <em>presonnal settings</em> to get your key</li>
                                <li>Copy this key in place of the password in your <em>~/.m2/settings.xml</em></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>
            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">DevBox Maven Setup</span> - <span
                        style="color:crimson;font-size: large;">Non GE Employee</span></h6>
                <div style="float: left;width:100%;font-size: x-large;" align="left">
                    <ul>
                        <li>On the devbox open <em>~/.m2/settings.xml</em></li>
                        <li>Search for proxies</li>
                        <p>&lt;proxies&gt;<br/> &lt;proxy&gt;<br/> &lt;id&gt;corporate&lt;/id&gt;<br/> &lt;active&gt;true&lt;/active&gt;<br/>
                            &lt;protocol&gt;http&lt;/protocol&gt;<br/> &lt;host&gt;sjc1intproxy01.crd.ge.com&lt;/host&gt;<br/>
                            &lt;port&gt;8080&lt;/port&gt;<br/> &lt;username&gt;proxyuser&lt;/username&gt;<br/> &lt;password&gt;proxypass&lt;/password&gt;<br/>
                            &lt;nonProxyHosts&gt;127.0.0.1,localhost,localhost.localdomain,*.ge.com&lt;/nonProxyHosts&gt;<br/>
                            &lt;/proxy&gt;<br/> &lt;/proxies&gt;</p>
                        <li>Comment the whole block</li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">Maven Setup</span></h6>
                <div style="float: left;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>If you are on a mac or on linux copy this file <a href="./settings.xml">settings.xml</a> to
                            <em>~/.m2/settings.xml</em></li>
                        <li>Redo the same as previously
                            <ul>
                                <li>With or without the proxy depending of your network</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>
            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">Java Language</span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>The Devbox comes with STS Tool suite (eclipse based IDE)</li>
                        <li>JDK version is 1.8.0_111</li>
                        <li>Maven version 3.3.9</li>
                    </ul>
                </div>
                <br/>
                <div style="float: bottom;width:100%;font-size: xx-large;" align="left">
                    <ul style="font-style:oblique;">
                        <li>During this training we will use only the devbox for simplicity sake</li>
                        <li>Using OSX or Linux is more efficient for heavy duty development</li>
                    </ul>
                </div>
            </section>
            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">Non Java Languages</span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>For non Java Languages development the devbox include Atom Editor which more than sufficient
                            for the scope of this training
                        </li>
                        <li>For serious development investing into a Intellij Ultimate License might be a good idea</li>
                    </ul>
                </div>
                <br/>
                <div style="float: bottom;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Node version: 6.3.0</li>
                        <li>Npm version: 3.10.3</li>
                        <li>Python version: 2.7.5</li>
                        <li>Python version: 3.4.3</li>
                        <li>gcc version: 4.8.5</li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">Cf cli</span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>A simple, text-based Cloud Foundry client</li>
                        <li>Used by <b>operators</b> and <b>developers</b> to access and work with any Cloud Foundry
                            installation
                        </li>
                        <li>Anything you do with the CLI can be scripted/automated</li>
                    </ul>
                </div>
                <br/>
                <div style="float: bottom;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Already install on the devbox</li>
                        <li>OSX install: <code style="font-size: x-large;">brew tap cloudfoundry/tap &&
                            brew install cf-cli</code></li>
                        <li>Test after install <code style="font-size: x-large;"> cf --version
                            </br> cf version 6.22.2+a95e24c-2016-10-27</code>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">Cf cli primer</span></h6>
                <div style="float: top;width:100%;font-size: x-large;" align="left">
                    <ul>
                        <li>Getting some help
                            <ul>
                                <li><code style="font-size: x-large;"> cf --help</code></li>
                            </ul>
                            <ul>
                                <li><code style="font-size: x-large;"> cf help {command}</code></li>
                            </ul>
                        </li>
                        <li>Login to Cf
                            <ul>
                                <li><code style="font-size: x-large;">cf login -a
                                    https://api.system.aws-usw02-pr.ice.predix.io</code></li>
                                <li>Enter your login and password</li>
                            </ul>
                        </li>
                        <li>Set your Org and Space
                            <ul>
                                <li><code style="font-size: x-large;">cf target -o {Orgname} -s
                                    {SpaceName} </code>
                                </li>
                            </ul>
                        </li>
                        <li>List services available
                            <ul>
                                <li><code style="font-size: x-large;">cf marketplace</code></li>
                            </ul>
                        </li>
                        <li>List running application
                            <ul>
                                <li><code style="font-size: x-large;">cf apps</code></li>
                            </ul>
                        </li>
                        <li>List running services
                            <ul>
                                <li><code style="font-size: x-large;">cf services</code></li>
                            </ul>
                        </li>
                        <li>Deploy an application
                            <ul>
                                <li><code style="font-size: x-large;">cf push -f manifest.yml</code></li>
                                <li>The manifest file describes what kind application you have and all its service
                                    dependencies
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">Cf cli primer suite</span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Get log of your app
                            <ul>
                                <li><code style="font-size: x-large;">cf logs {AppName}</code></li>
                                <li>Only latest ones <code style="font-size: x-large;color:darkgrey;">cf logs --recent
                                    {AppName}</code></li>
                            </ul>
                        </li>
                        <li>Delete an app
                            <ul>
                                <li><code style="font-size: x-large;">cf delete {AppName}</code></li>
                            </ul>
                        </li>
                        <li>Get Environment of an applications
                            <ul>
                                <li><code style="font-size: x-large;">cf env {AppName}</code></li>
                            </ul>
                        </li>
                        <li>List running services
                            <ul>
                                <li><code style="font-size: x-large;">cf services </code></li>
                            </ul>
                        </li>
                        <li>Get info of a given app
                            <ul>
                                <li><code style="font-size: x-large;">cf app {AppName}</code></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Dev Tools - <span style="color:cadetblue;">The .cf Directory </span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>cf creates a .cf directory in your home directory</li>
                        <li>Stores context, logs, crash reports ...</li>
                        <li>Remembers your CF API endpoint
                            <ul>
                                <li>Don't need to specify -a option at next login</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">Few cf cli usage </span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Set your org</li>
                        <li>Create a space named <em>lab</em></li>
                        <li>Set target to lab</li>
                        <li>Create a space named <em>lab2</em></li>
                        <li>Set target to lab2</li>
                        <li>Set target to lab</li>
                        <li>Delete space named <em>lab2</em></li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">Few cf cli usage </span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li><code style="font-size: x-large;">cf target -o "Email"</code></li>
                        <li><code style="font-size: x-large;">cf create-space lab</code></li>
                        <li><code style="font-size: x-large;">cf target -s "lab"</code></li>
                        <li><code style="font-size: x-large;">cf create-space lab2</code></li>
                        <li><code style="font-size: x-large;">cf target -s "lab2"</code></li>
                        <li><code style="font-size: x-large;">cf target -s "lab"</code></li>
                        <li><code style="font-size: x-large;">cf delete-space "lab2"</code></li>
                        <li><code style="font-size: x-large;">cf target -s "lab"</code></li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">The first app </span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li><code style="font-size: x-large;color:darkgrey;">mkdir nullApp && cd nullApp</code></li>
                        <li><code style="font-size: x-large;color:darkgrey;">touch Procfile</code></li>
                        <li><code style="font-size: x-large;color:darkgrey;">cf push nullApp -b
                            http://github.com/ryandotsmith/null-buildpack.git --no-start --no-route -m 64M -k 64M</code>
                        </li>
                    </ul>
                </div>
                <br/>
                <div style="float: bottom;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Using cf cli try to :
                            <ul>
                                <li>Check the logs</li>
                                <li>Try to scale it to two instances</li>
                                <li>Try to restart the application</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>
        </section>

        <section>

            <section>
                <h6>Predix Security Model - <span style="color:cadetblue;"> Architecture intro </span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>All inbound Communications are using ssl :
                            <ul>
                                <li><em>https://</em> is the default and must be used as default prefix in the browser
                                </li>
                                <li>For web socket wss is used</li>
                            </ul>
                        </li>
                        <li> No direct tcp inbound : mqtt is not possible</li>
                        <li>Only TLS 1.2 is possible some iot devices not supported</li>
                        <li>Authentication is done using OAuth2.0</li>
                    </ul>
                </div>
                <br/>
                <div style="float: bottom;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>In CF this role is taken by the UAA service (java service)
                            <ul>
                                <li>Stores user account</li>
                                <li>Stores client</li>
                                <li>Validate token</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Security Model - <span style="color:cadetblue;"> UAA intro </span></h6>
                <div style="float:left;width:120%;font-size: x-large;" align="left">
                    <ul>
                        <li>We must differentiate two kind of usages :
                            <ul>
                                <li style="float:left ;width:50%;" align="left">
                                    Resource access:
                                    <img src="./images/oauth2-get-client.png"/>
                                </li>
                                <li style="float:right ;width:50%;" align="left">
                                    User login:
                                    <img src="./images/oauth2-get-client-auth-code.png"/>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Security Model - <span style="color:cadetblue;"> UAA endpoints </span></h6>
                <div style="float:left;width:120%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Obtain access token at <em>/oauth/token</em></li>
                        <li>Inspect access token at <em>/check_token</em></li>
                        <li>Obtain token key (for decoding JWT tokens locally) at <em>/token_key</em></li>
                        <li>Login ui to access application <em>/login</em></li>
                        <li>Authorization Requests Code <em>/oauth/authorize</em></li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Security Model - <span style="color:cadetblue;">OAuth2</span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Resource Access is very suited for stateless services (without any session)
                            <ul>
                                <li>
                                    Only <em>Client(client_id/client_secret)</em> is needed
                                </li>
                            </ul>
                        </li>
                        <li>User login required a session storage (using redis most of the time)
                            <ul>
                                <li>
                                    Require a <em>User Account (login/password)</em> in UAA, a <em> CLient
                                    (client_id/client_secret</em> and a <em>Callback</em> setup
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <br/>
                <div style="float: bottom;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Each time a token is generated we must pay attention to:
                            <ul>
                                <li>it's expiration date</li>
                                <li>it's validation</li>
                            </ul>
                        </li>
                        <li>If the token expire it's needs to be refreshed</li>
                        <li>To validate the token a call to UAA service is needed (extra latency): Fast token to the
                            rescue
                            <ul>
                                <li> it's a library that fetch the UAA token signing key at startup and perform the
                                    validation locally.
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Predix Security Tools - <span style="color:cadetblue;">uaac cli</span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>A simple, text-based Cloud foundry uaa client</li>
                        <li>Used by <b>operators</b> and <b>developers</b> to access and work with uaa service instances
                        </li>
                        <li>Anything you do with the uua cli can be scripted/automated</li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>uaac cli - <span style="color:cadetblue;"> primer </span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Install OSX
                            <ul>
                                <li><code style="font-size: x-large;">gem install cf-uaac
                                </code>
                                </li>
                            </ul>
                        </li>
                        <li>Install Linux
                            <ul>
                                <li><code style="font-size: x-large;color:red;">TODO
                                </code>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>uaac cli - <span style="color:cadetblue;"> primer</span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Set target uaa
                            <ul>
                                <li><code style="font-size: x-large;">uaa target {uaaUri}</code></li>
                            </ul>
                        </li>
                        <li>Get client token
                            <ul>
                                <li><code style="font-size: x-large;">uaac token client get -s
                                    {uaa_admin_secret} </code></li>
                            </ul>
                        </li>
                        <li>Create uaa client
                            <ul>
                                <li><code style="font-size: x-large;">uaac client add {client_id} -s
                                    {client_secret} </code></li>
                            </ul>
                        </li>
                        <li>Update uaa client
                            <ul>
                                <li><code style="font-size: x-large;">uaac client update {client_id}
                                    {Additional properties} </code></li>
                            </ul>
                        </li>
                        <li>Create a group
                            <ul>
                                <li><code style="font-size: x-large;">uaac group add {groupname}</code>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">UAA </span></h6>
                <div style="float: top;width:100%;font-size: x-large;" align="left">
                    <ul>
                        <li>Using the predix.io console create an UAA service in the space <em>lab</em>
                            <ul>
                                <li>Space: <em>lab</em></li>
                                <li>Instance name: <em>uaa-lab</em></li>
                                <li>Use the <em>Free Plan</em></li>
                                <li>Please keep the password</li>
                                <li>Use <em>lab</em> as subdomains</li>
                            </ul>
                        </li>
                        <li>Select space lab and click on uaa-lab service, login using the password previously saved
                        </li>
                        <li>Add a new client <em>lab-client</em> using the Service instance ui
                            with the following
                            parameters
                            <ul>
                                <li>Client Id:<em>rest_client</em></li>
                                <li>Grant type: <em>client_credentials</em></li>
                                <li>Client Secret: <em>{PICK ONE}</em></li>
                                <li>Scope: <em>uaa.none</em></li>
                                <li>Authorities: <em>uaa.none</em></li>
                                <li>Allowed Providers: <em>uaa</em></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">UAA Automation</span></h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    We said that anything done with cf and uaac cli can be automated...<br/>
                    <code style="font-size: large;color:darkgrey;">
                        cf cs predix-uaa Free "uua-lab" -c
                        '{"adminClientSecret":"{UAA_SECRET}","subdomain":"lab"}'
                    </code>
                </div>
                </br>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <div style="font-size: large;color:darkgrey;">
                        <code>uaac target https://lab.predix-uaa.run.aws-usw02-pr.ice.predix.io</code> </br>
                        <code>uaac token client get admin -s {UAA_SECRET}</code> </br>
                        <code style="font-size: large;color:darkgrey;">
                            uaac client add rest_client -s "{CLIENT_SECRET}" --authorized_grant_types
                            "client_credentials" --scope "uaa.none" --authorities "uaa.none"
                        </code>
                    </div>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;"> Explanation</span></h6>
                <div style="float: top;width:100%;font-size: x-large;" align="left">
                    <ul>
                        <li>Grant type:
                            <ul>
                                <li>An access token can be requested in four different ways, in the Oauth specification
                                    they are referred to as grant types:
                                    <ul>
                                        <li><em>client_credentials</em> - no user involved. requesting a token to
                                            represent a client only
                                        </li>
                                        <li><em>password</em> - the client uses the user's credentials and passes them
                                            to the UAA to generate a token.
                                        </li>
                                        <li><em>implicit</em> - this is similar to the password grant, but a client
                                            password(secret) is not needed
                                        </li>
                                        <li><em>authorization_code</em> - in this scenario, the client never sees the
                                            user's credentials. It is the most secure grant type but relies on 302
                                            redirects from the HTTP protocol.
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li>Scope:
                            <ul>
                                <li> Scopes are essentially permissions, and are added as a named parameter in the
                                    access token.
                                    <ul>
                                        <li><em>scope</em> - when the token represents a client acting on behalf of a
                                            user
                                        </li>
                                        <li><em>authorities</em> - when the token represents the client (application)
                                            itself
                                        </li>
                                    </ul>

                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <aside class="notes">
                    This is how the permissions are labeled in the token by the UAA. When a resource
                    server receives a request containing a token, the server can make a decision
                    based on the scopes in the token. The resource MUST validate the token first,
                    there are several ways of doing this discussed in the Oauth 2 specification.
                    The resource server must differentiate between a client only token, and read
                    'authorities', or a client on behalf of user token to read the 'scope' field.
                    The name of the scope, such as <em>password.write</em> are arbitrary strings.
                    They don't mean anything to any component except the resource server that uses
                    them for authorization. For example, <em>password.write</em> is a scope that the
                    must be present in the token when a request to the UAA is made for a password
                    change.
                    Scopes, are arbitrary strings, defined by the client itself. The UAA does use
                    the base name of a scope and adds it to the audience field. The 'base name' is
                    defined as anything before the last dot.
                </aside>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">Resource access</span> <span
                        style="color:crimson;font-size: large;"> Devbox </span>
                </h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>In the devbox open chrome and install <em>postman</em> its a chrome extension that allow you
                            to call any rest api
                        </li>
                        <li>Enter the url of the uaa service <br/> <code>https://lab.predix-uaa.run.aws-usw02-pr.ice.predix.io</code>
                            plus add the extension to obtain a token
                        </li>
                        <li>Send a basic authentication <em>POST</em> request to get a JSON web token for the client
                            <em>rest_client</em></li>

                        <li>You should have something like:</li>
                    </ul>
                    <pre><code data-trim data-noescape>
{
    "access_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImxlZ2FjeS10b2tlbi1rZXkiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiI5MzM3Yzc5MzE5MmE0MDcwYjA5ZmQ2MzdmZDZkMzY5MSIsInN1YiI6InJlc3RfY2xpZW50Iiwic2NvcGUiOlsidWFhLm5vbmUiXSwiY2xpZW50X2lkIjoicmVzdF9jbGllbnQiLCJjaWQiOiJyZXN0X2NsaWVudCIsImF6cCI6InJlc3RfY2xpZW50IiwiZ3JhbnRfdHlwZSI6ImNsaWVudF9jcmVkZW50aWFscyIsInJldl9zaWciOiIzMDBkYmJkOCIsImlhdCI6MTQ4MTEyODIwMSwiZXhwIjoxNDgxMTcxNDAxLCJpc3MiOiJodHRwczovL2xhYi5wcmVkaXgtdWFhLnJ1bi5hd3MtdXN3MDItcHIuaWNlLnByZWRpeC5pby9vYXV0aC90b2tlbiIsInppZCI6IjIyMTQ0NmQyLTNiNWUtNDAyYy1hNmQ1LTZhYWVjZTIyZDQzYiIsImF1ZCI6WyJyZXN0X2NsaWVudCJdfQ.h3QEK1hP5pgWWpYRoqnthKhh7_FbhKXSs_7tbEcOvqB59E46zFDC4btiBJjN7k6D1waTkuHaXiXaUxpnijwDamsHl7qfayHBkX5tDie7YQL9v4n49AJpLkA-sONDbdjr0TdbtlLYxqABInHoWEQgWEHhMBWrZDfFCiIneRWNCvwAS_d84bm2YeoodlLBG8tfo3IxxDOaB_HD0kaxeR5X54lvoahXC31m3STsxqbZSsODTggIPgphKfnQH4oSmVePDpA1LV51J0r32EhPXvXEUOSkzad3wlr365Hp7Gb36J3i-d4yfbRqLSreMmI7h2AFbBy4M5YhKHEt_DlzWnOJBw","token_type": "bearer",
    "expires_in": 43199,
    "scope": "uaa.none",
    "jti": "9337c793192a4070b09fd637fd6d3691"
}
                    </code></pre>
                    <ul>
                        <div style="float: top;width:100%;font-size: x-large;">Hints:
                            <ul>
                                <li>You need a Basic Auth Header (Postman can generate it for you) containing
                                    {client_id}:{client_secret}
                                </li>
                                <li>The body of the request need to include the <em>grant_type</em></li>
                                <li> Use <em>x-www-form-urlencoded</em></li>
                            </ul>
                        </div>
                    </ul>
                </div>
            </section>
            <section>
                <h6>Lab - <span style="color:deeppink;">Resource access</span> <span
                        style="color:crimson;font-size: large;"> Devbox </span>
                </h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>Enter the url of the uaa service <br/> <code>https://lab.predix-uaa.run.aws-usw02-pr.ice.predix.io</code>
                            plus add the extension to check a token
                        </li>
                        <li>Send a basic authentication <em>POST</em> request to check the bearer token
                            <em>rest_client</em></li>
                        <li>You should have something like:</li>
                    </ul>
                    <pre><code data-trim data-noescape>
{"error":"access_denied","error_description":"Access is denied"}
                    </code></pre>
                    <ul>
                        <div style="float: top;width:100%;font-size: x-large;">Hints:
                            <ul>
                                <li>You need a Basic Auth Header (Postman can generate it for you) containing
                                    {client_id}:{client_secret}
                                </li>
                                <li>The body of the request need to include the <em>token_type</em> with <em>bearer</em> and
                                    <em>bearer</em> to the token you got from the previous call.
                                </li>
                                <li>Use <em>x-www-form-urlencoded</em></li>
                            </ul>
                        </div>
                    </ul>
                </div>
            </section>
            <section>
                <h6>Lab - <span style="color:deeppink;">Resource access</span> <span
                        style="color:crimson;font-size: large;"> Devbox </span>
                </h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>To check the token the client needs to have <em>uaa.resource</em> in its
                            <em>Authorities</em></li>
                        <li>Using the UAA dashboard edit the client to update the client</li>
                        <li>ReSend the previous request request</li>
                        <li>You should have something like:</li>
                    </ul>
                    <pre><code data-trim data-noescape>
                        {
  "client_id": "rest_client",
  "exp": 1481172828,
  "scope": [
    "uaa.none"
  ],
  "jti": "d8fd8a1cc0714bfd97870ff50f677034",
  "aud": [
    "rest_client"
  ],
  "sub": "rest_client",
  "iss": "https://lab.predix-uaa.run.aws-usw02-pr.ice.predix.io/oauth/token",
  "iat": 1481129628,
  "cid": "rest_client",
  "grant_type": "client_credentials",
  "azp": "rest_client",
  "zid": "221446d2-3b5e-402c-a6d5-6aaece22d43b",
  "rev_sig": "300dbbd8",
  "revocable": false
}
                    </code></pre>
                </div>
            </section>
            <section>
                <h6>Lab - <span style="color:deeppink;">Resource access </span> <span
                        style="color:crimson;font-size: large;"> Non-Devbox </span>
                </h6>
                <div style="float: top;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li>To check the token the client needs to have <em>uaa.resource</em> in its
                            <em>Authorities</em></li>
                        <li>Using the uaac cli to update the client</li>
                        <li>ReSend the previous request request</li>
                        <li>You should have something like:</li>
                    </ul>
                    <pre><code data-trim data-noescape>
                        {
  "client_id": "rest_client",
  "exp": 1481172828,
  "scope": [
    "uaa.none"
  ],
  "jti": "d8fd8a1cc0714bfd97870ff50f677034",
  "aud": [
    "rest_client"
  ],
  "sub": "rest_client",
  "iss": "https://lab.predix-uaa.run.aws-usw02-pr.ice.predix.io/oauth/token",
  "iat": 1481129628,
  "cid": "rest_client",
  "grant_type": "client_credentials",
  "azp": "rest_client",
  "zid": "221446d2-3b5e-402c-a6d5-6aaece22d43b",
  "rev_sig": "300dbbd8",
  "revocable": false
}
                    </code></pre>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">Resource access</span> <span
                        style="color:crimson;font-size: large;"> Non-Devbox Solution</span>
                </h6>
                <div style="float: top;width:100%;font-size: x-large;" align="left">
                    <code>uaac target https://lab.predix-uaa.run.aws-usw02-pr.ice.predix.io</code> <br/>
                    <code>uaac token client get admin -s {UAA_SECRET}</code> <br/>
                    <code>
                        uaac client update rest_client --authorities "uaa.none uaa.resource"
                    </code>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">UAA Login</span> <span style="color:crimson;font-size: large;"> Devbox </span>
                </h6>
                <div style="float: top;width:100%;font-size: x-large;" align="left">
                    <ul>
                        <li>Using the UAA dashboard create a new client name <em>login_client</em> with the following
                            properties:
                            <ul>
                                <li>Client Id:<em>login_client</em></li>
                                <li>Grant type: <em>authorization_code</em></li>
                                <li>Client Secret: <em>{client_secret}</em></li>
                                <li>Scope: <em>uaa.none</em></li>
                                <li>Authorities: <em>uaa.none</em> and <em>uaa.user</em></li>
                                <li>Allowed Providers: <em>uaa</em></li>
                                <li>Redirect URL: <em>https://www.getpostman.com/oauth2/callback</em></li>
                            </ul>
                        </li>
                        <li>Create a User with the following properties:
                            <ul>
                                <li>User Name: <em>{Pick one email}</em></li>
                                <li>Email: <em>{Pick one email}</em></li>
                                <li>Password: <em>{Pick one}</em></li>
                                <li>Given Name: <em>{Pick One}</em></li>
                                <li>Active: check it</li>
                                <li>Verified: check it</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">UAA Login</span> <span
                        style="color:crimson;font-size: large;"> Non-Devbox Solution</span>
                </h6>
                <div style="float: top;width:100%;font-size: x-large;" align="left">
                    <code>uaac target https://lab.predix-uaa.run.aws-usw02-pr.ice.predix.io</code> <br/>
                    <code>uaac token client get admin -s {UAA_SECRET}</code> <br/>
                    <code>
                        uaac client add login_client --authorized_grant_types
                        "authorization_code" --scope "uaa.none uaa.user" --authorities "uaa.none" --authorities
                        "uaa.none" --redirect_uri "https://www.getpostman.com/oauth2/callback"
                    </code><br/>
                    <code>
                        uaac user add {Pick One} --emails "{Pick One}" --given_name "{Pick One}" -p "{Pick One}"
                    </code>
                </div>
            </section>

            <section>
                <h6>Lab - <span style="color:deeppink;">UAA Login </span> <span style="color:crimson;font-size: large;"> Devbox </span>
                </h6>
                <div style="float: top;width:100%;font-size: x-large;" align="left">
                    <ul>
                        <li>In postman open Authentication Helper and select OAuth2.0 and enter :
                            <ul>
                                <li>Token Name: <em>Bearer</em></li>
                                <li>Auth URL:
                                    <em>https://lab.predix-uaa.run.aws-usw02-pr.ice.predix.io/oauth/authorize</em></li>
                                <li>Access Token URL: <em>https://lab.predix-uaa.run.aws-usw02-pr.ice.predix.io/oauth/token</em>
                                </li>
                                <li>Client ID: login_client</li>
                                <li>Client Secret: {client_secret}</li>
                                <li>Grant Type: <em>Authorization Code</em></li>
                            </ul>
                        </li>
                        <li>Press Request Token</li>
                        <li>At the end you will have a Bearer token registered that could be added to to any request</li>
                    </ul>
                </div>
                <div style="float: bottom;width:100%;font-size: xx-large;" align="left">
                    <ul>
                        <li class="fragment fade-up">What can be added to remove the approval step ?</li>
                        <li class="fragment fade-up">
                            <code>
                                uaac client update login_client --autoapprove "uaa.user"
                            </code>
                        </li>
                    </ul>
                </div>
            </section>
        </section>
    </div>
</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>
    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        history: true,

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
            {src: 'plugin/markdown/marked.js'},
            {src: 'plugin/markdown/markdown.js'},
            {src: 'plugin/notes/notes.js', async: true},
            {
                src: 'plugin/highlight/highlight.js', async: true, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            }
        ]
    });
</script>
</body>
</html>
